
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PostgreSQL / pgRouting &#8212; Open Source Routing Library</title>
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="search" title="Search" href="../../search.html" />
    

  </head><body>
    <div class="header">
        <div class="wrap">
            <h1 id="logo"><a href="../../index.html">pgRouting</a></h1>
            <ul id="top-nav">
                <li class="first"><a href="../../index.html">Home</a></li>
                <li><a href="../../documentation.html">Documentation</a></li>
                <li><a href="../../download.html">Download</a></li>
                <li><a href="../../support.html">Support</a></li>
                <li><a href="../../development.html">Development</a></li>
            </ul>

            <div id="searchbox">
                <form class="search" action="../../search.html" method="get">
                    <input id="searchbox-query" type="text" name="q" size="25" value="Search &hellip;" tabindex="3" onblur="if(this.value=='') this.value='Search &hellip;';" onfocus="if(this.value=='Search &hellip;') this.value='';" />
                    <input id="searchbox-submit" type="image" value="Search" src="../../_static/img/search_icon_green.png" />
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
            </div>
        </div>
    </div>

    	
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../index.html">Home</a> &#187;</li>
        <li><a href="#">PostgreSQL / pgRouting</a></li>
      </ul>
    </div>
    

    	
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PostgreSQL / pgRouting</a><ul>
<li><a class="reference internal" href="#create-a-routing-database">Create a routing database</a></li>
<li><a class="reference internal" href="#load-routing-data">Load routing data</a><ul>
<li><a class="reference internal" href="#import-a-clip-victoria-downtown-area-of-the-british-columbia-road-network-data">Import a clip (Victoria Downtown area) of the British Columbia road network data.</a></li>
<li><a class="reference internal" href="#add-the-geometry-column">Add the geometry column:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#prepare-routing-table-for-dijkstra">Prepare routing table for Dijkstra</a><ul>
<li><a class="reference internal" href="#add-source-target-and-length-column">Add source, target and length column</a></li>
<li><a class="reference internal" href="#create-network-topology">Create network topology</a></li>
<li><a class="reference internal" href="#create-indexes-for-source-target-and-geometry-column">Create indexes for source, target and geometry column</a></li>
<li><a class="reference internal" href="#run-shortest-path-dijkstra-query">Run Shortest Path Dijkstra query</a><ul>
<li><a class="reference internal" href="#shortest-path-core-function">Shortest path core function</a></li>
<li><a class="reference internal" href="#wrapper-function-without-bounding-box">Wrapper function without bounding box</a></li>
<li><a class="reference internal" href="#wrapper-function-with-bounding-box">Wrapper function with bounding box</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prepare-routing-table-for-a-star">Prepare routing table for A-Star</a><ul>
<li><a class="reference internal" href="#add-x1-y1-and-x2-y2-column">Add x1, y1 and x2, y2 column</a></li>
<li><a class="reference internal" href="#run-shortest-path-a-star-query">Run Shortest Path A-Star query</a><ul>
<li><a class="reference internal" href="#a-star-core-function">A-Star core function</a></li>
<li><a class="reference internal" href="#id1">Wrapper function with bounding box</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prepare-routing-table-for-shooting-star">Prepare routing table for Shooting-Star</a><ul>
<li><a class="reference internal" href="#id2">Add x1, y1 and x2, y2 column</a></li>
<li><a class="reference internal" href="#run-shortest-path-shooting-star-query">Run Shortest Path Shooting-Star query</a></li>
<li><a class="reference internal" href="#shooting-star-core-function">Shooting-Star core function</a></li>
<li><a class="reference internal" href="#id3">Wrapper function with bounding box</a></li>
</ul>
</li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="postgresql-pgrouting">
<span id="foss4g2007-ch02"></span><h1>PostgreSQL / pgRouting<a class="headerlink" href="#postgresql-pgrouting" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The content of this page is outdated and is for archiving purposes only.</p>
</div>
<div class="section" id="create-a-routing-database">
<h2>Create a routing database<a class="headerlink" href="#create-a-routing-database" title="Permalink to this headline">¶</a></h2>
<p>We will create a database “routing” and load the PostGIS and pgRouting functions.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>createdb -U postgres -E UNICODE routing
createlang -U postgres plpgsql routing
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> /usr/share/postgresql/8.2/contrib/
psql -U postgres -f postgis-1.2.1/lwpostgis.sql routing
psql -U postgres -f postgis-1.2.1/spatial_ref_sys.sql routing
</pre></div>
</div>
<p>The sql-data will probably be in /usr/share/postlbs/</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psql -U postgres -f routing_core.sql routing
psql -U postgres -f routing_core_wrappers.sql routing
psql -U postgres -f routing_topology.sql routing
psql -U postgres -f matching.sql routing
</pre></div>
</div>
</div>
<div class="section" id="load-routing-data">
<h2>Load routing data<a class="headerlink" href="#load-routing-data" title="Permalink to this headline">¶</a></h2>
<p>The data we use for routing is the <a class="reference external" href="http://geobase.ca/geobase/en/data/nrn/index.html">Geobase</a>
“National Road Network” dataset for British Columbia (nrn_rrn_bc_shp_en.zip).
It is available in shape file format and can be loaded into PostgreSQL using
“shp2pgsql”.
A long list of attributes comes with the road network data, but most of them do
not contain data.
For this routing workshop we will only keep “gid”, “id” and “the_geom”.</p>
<p>To overlay the route with Google Maps the data has been reprojected to
EPSG 54004 meanwhile you better use: EPSG 900913)</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>        <span class="k">Column</span>    <span class="o">|</span>       <span class="k">Type</span>       <span class="o">|</span> <span class="n">Modifiers</span>
<span class="c1">--------------+------------------+-----------</span>
 <span class="n">gid</span>          <span class="o">|</span> <span class="nb">integer</span>          <span class="o">|</span>
 <span class="n">id</span>           <span class="o">|</span> <span class="nb">integer</span>          <span class="o">|</span>
 <span class="n">the_geom</span>     <span class="o">|</span> <span class="n">geometry</span>         <span class="o">|</span>
</pre></div>
</div>
<div class="section" id="import-a-clip-victoria-downtown-area-of-the-british-columbia-road-network-data">
<h3>Import a clip (Victoria Downtown area) of the British Columbia road network data.<a class="headerlink" href="#import-a-clip-victoria-downtown-area-of-the-british-columbia-road-network-data" title="Permalink to this headline">¶</a></h3>
<p>A table named “victoria” will be created automatically.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>psql -U postgres routing
<span class="se">\i</span> /home/pgrouting/RoutingData/victoria.sql
</pre></div>
</div>
<p>(The network extent is “-13737893, 6141906, -13728396, 6151394”)</p>
</div>
<div class="section" id="add-the-geometry-column">
<h3>Add the geometry column:<a class="headerlink" href="#add-the-geometry-column" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">RENAME</span> <span class="k">COLUMN</span> <span class="n">the_geom</span> <span class="k">TO</span> <span class="n">geom</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">AddGeometryColumn</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span><span class="s1">&#39;the_geom&#39;</span><span class="p">,</span><span class="mi">54004</span><span class="p">,</span><span class="s1">&#39;MULTILINESTRING&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">the_geom</span><span class="o">=</span><span class="n">geom</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">DROP</span> <span class="k">COLUMN</span> <span class="n">geom</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="prepare-routing-table-for-dijkstra">
<h2>Prepare routing table for Dijkstra<a class="headerlink" href="#prepare-routing-table-for-dijkstra" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-source-target-and-length-column">
<h3>Add source, target and length column<a class="headerlink" href="#add-source-target-and-length-column" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="k">source</span> <span class="nb">integer</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">target</span> <span class="nb">integer</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="k">length</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="create-network-topology">
<h3>Create network topology<a class="headerlink" href="#create-network-topology" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">assign_vertex_id</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">001</span><span class="p">,</span> <span class="s1">&#39;the_geom&#39;</span><span class="p">,</span> <span class="s1">&#39;gid&#39;</span><span class="p">);</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="k">length</span> <span class="o">=</span> <span class="k">length</span><span class="p">(</span><span class="n">the_geom</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="create-indexes-for-source-target-and-geometry-column">
<h3>Create indexes for source, target and geometry column<a class="headerlink" href="#create-indexes-for-source-target-and-geometry-column" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">source_idx</span> <span class="k">ON</span> <span class="n">victoria</span><span class="p">(</span><span class="k">source</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">target_idx</span> <span class="k">ON</span> <span class="n">victoria</span><span class="p">(</span><span class="n">target</span><span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">geom_idx</span> <span class="k">ON</span> <span class="n">victoria</span> <span class="k">USING</span> <span class="n">GIST</span><span class="p">(</span><span class="n">the_geom</span> <span class="n">GIST_GEOMETRY_OPS</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="run-shortest-path-dijkstra-query">
<h3>Run Shortest Path Dijkstra query<a class="headerlink" href="#run-shortest-path-dijkstra-query" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">shortest_path</span><span class="p">(</span> <span class="k">sql</span> <span class="nb">text</span><span class="p">,</span>
                   <span class="n">source_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">target_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">directed</span> <span class="nb">boolean</span><span class="p">,</span>
                   <span class="n">has_reverse_cost</span> <span class="nb">boolean</span> <span class="p">)</span>
</pre></div>
</div>
<p>(Source and target IDs are node IDs.)</p>
<div class="section" id="shortest-path-core-function">
<h4>Shortest path core function<a class="headerlink" href="#shortest-path-core-function" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">shortest_path</span><span class="p">(</span><span class="s1">&#39;</span>
<span class="s1">                SELECT gid as id,</span>
<span class="s1">                         source::integer,</span>
<span class="s1">                         target::integer,</span>
<span class="s1">                         length::double precision as cost</span>
<span class="s1">                        FROM victoria&#39;</span><span class="p">,</span>
                <span class="mi">238</span><span class="p">,</span> <span class="mi">1455</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span> <span class="n">vertex_id</span> <span class="o">|</span> <span class="n">edge_id</span> <span class="o">|</span>       <span class="n">cost</span>
<span class="c1">-----------+---------+------------------</span>
           <span class="mi">238</span> <span class="o">|</span>   <span class="mi">76619</span> <span class="o">|</span> <span class="mi">172</span><span class="p">.</span><span class="mi">172139617447</span>
          <span class="mi">1051</span> <span class="o">|</span>   <span class="mi">80792</span> <span class="o">|</span> <span class="mi">309</span><span class="p">.</span><span class="mi">209732132692</span>
           <span class="mi">632</span> <span class="o">|</span>   <span class="mi">22142</span> <span class="o">|</span> <span class="mi">275</span><span class="p">.</span><span class="mi">695065878201</span>
           <span class="p">...</span> <span class="o">|</span>     <span class="p">...</span> <span class="o">|</span> <span class="p">...</span>
</pre></div>
</div>
</div>
<div class="section" id="wrapper-function-without-bounding-box">
<h4>Wrapper function without bounding box<a class="headerlink" href="#wrapper-function-without-bounding-box" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">gid</span><span class="p">,</span> <span class="n">AsText</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom</span>
        <span class="k">FROM</span> <span class="n">dijkstra_sp</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">1455</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>  <span class="n">gid</span>   <span class="o">|</span>                              <span class="n">the_geom</span>
<span class="c1">--------+---------------------------------------------------------------</span>
        <span class="mi">484</span> <span class="o">|</span> <span class="n">MULTILINESTRING</span><span class="p">((</span><span class="o">-</span><span class="mi">13735834</span><span class="p">.</span><span class="mi">0196717</span> <span class="mi">6151280</span><span class="p">.</span><span class="mi">78177026</span><span class="p">,</span> <span class="p">...</span> <span class="p">))</span>
  <span class="mi">13944</span> <span class="o">|</span> <span class="n">MULTILINESTRING</span><span class="p">((</span><span class="o">-</span><span class="mi">13734179</span><span class="p">.</span><span class="mi">5114759</span> <span class="mi">6150720</span><span class="p">.</span><span class="mi">27269911</span><span class="p">,</span> <span class="p">...</span> <span class="p">))</span>
  <span class="mi">22142</span> <span class="o">|</span> <span class="n">MULTILINESTRING</span><span class="p">((</span><span class="o">-</span><span class="mi">13733851</span><span class="p">.</span><span class="mi">6421797</span> <span class="mi">6149933</span><span class="p">.</span><span class="mi">91231484</span><span class="p">,</span> <span class="p">...</span> <span class="p">))</span>
        <span class="p">...</span> <span class="o">|</span> <span class="p">...</span>
</pre></div>
</div>
</div>
<div class="section" id="wrapper-function-with-bounding-box">
<h4>Wrapper function with bounding box<a class="headerlink" href="#wrapper-function-with-bounding-box" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">gid</span><span class="p">,</span> <span class="n">AsText</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom</span>
        <span class="k">FROM</span> <span class="n">dijkstra_sp_delta</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">1455</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prepare-routing-table-for-a-star">
<h2>Prepare routing table for A-Star<a class="headerlink" href="#prepare-routing-table-for-a-star" title="Permalink to this headline">¶</a></h2>
<div class="section" id="add-x1-y1-and-x2-y2-column">
<h3>Add x1, y1 and x2, y2 column<a class="headerlink" href="#add-x1-y1-and-x2-y2-column" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">x1</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">y1</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">x2</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">y2</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">startpoint</span><span class="p">(</span><span class="n">the_geom</span><span class="p">));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">startpoint</span><span class="p">(</span><span class="n">the_geom</span><span class="p">));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">endpoint</span><span class="p">(</span><span class="n">the_geom</span><span class="p">));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">endpoint</span><span class="p">(</span><span class="n">the_geom</span><span class="p">));</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>“endpoint()” function fails for some versions of PostgreSQL (ie. 8.2.5, 8.1.9).
A workaround for that problem is using the “PointN()” function instead:</p>
<div class="last highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">PointN</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">PointN</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">PointN</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="n">NumPoints</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)));</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">PointN</span><span class="p">(</span><span class="n">the_geom</span><span class="p">,</span> <span class="n">NumPoints</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)));</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-shortest-path-a-star-query">
<h3>Run Shortest Path A-Star query<a class="headerlink" href="#run-shortest-path-a-star-query" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">shortest_path_astar</span><span class="p">(</span> <span class="k">sql</span> <span class="nb">text</span><span class="p">,</span>
                   <span class="n">source_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">target_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">directed</span> <span class="nb">boolean</span><span class="p">,</span>
                   <span class="n">has_reverse_cost</span> <span class="nb">boolean</span> <span class="p">)</span>
</pre></div>
</div>
<p>(Source and target IDs are node IDs.)</p>
<div class="section" id="a-star-core-function">
<h4>A-Star core function<a class="headerlink" href="#a-star-core-function" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">shortest_path_astar</span><span class="p">(</span><span class="s1">&#39;</span>
<span class="s1">                SELECT gid as id,</span>
<span class="s1">                         source::integer,</span>
<span class="s1">                         target::integer,</span>
<span class="s1">                         length::double precision as cost,</span>
<span class="s1">                         x1, y1, x2, y2</span>
<span class="s1">                        FROM victoria&#39;</span><span class="p">,</span>
                <span class="mi">238</span><span class="p">,</span> <span class="mi">1455</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h4>Wrapper function with bounding box<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">gid</span><span class="p">,</span> <span class="n">AsText</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom</span>
        <span class="k">FROM</span> <span class="n">astar_sp_delta</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">1455</span><span class="p">,</span> <span class="mi">3000</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prepare-routing-table-for-shooting-star">
<h2>Prepare routing table for Shooting-Star<a class="headerlink" href="#prepare-routing-table-for-shooting-star" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3>Add x1, y1 and x2, y2 column<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">reverse_cost</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
<span class="k">UPDATE</span> <span class="n">victoria</span> <span class="k">SET</span> <span class="n">reverse_cost</span> <span class="o">=</span> <span class="k">length</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">to_cost</span> <span class="n">double</span> <span class="k">precision</span><span class="p">;</span>
<span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">victoria</span> <span class="k">ADD</span> <span class="k">COLUMN</span> <span class="k">rule</span> <span class="nb">text</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="run-shortest-path-shooting-star-query">
<h3>Run Shortest Path Shooting-Star query<a class="headerlink" href="#run-shortest-path-shooting-star-query" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">shortest_path_shooting_star</span><span class="p">(</span> <span class="k">sql</span> <span class="nb">text</span><span class="p">,</span>
                   <span class="n">source_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">target_id</span> <span class="nb">integer</span><span class="p">,</span>
                   <span class="n">directed</span> <span class="nb">boolean</span><span class="p">,</span>
                   <span class="n">has_reverse_cost</span> <span class="nb">boolean</span> <span class="p">)</span>
</pre></div>
</div>
<p>(Source and target IDs are edge IDs.)</p>
</div>
<div class="section" id="shooting-star-core-function">
<h3>Shooting-Star core function<a class="headerlink" href="#shooting-star-core-function" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">shortest_path_shooting_star</span><span class="p">(</span><span class="s1">&#39;</span>
<span class="s1">                SELECT gid as id,</span>
<span class="s1">                         source::integer,</span>
<span class="s1">                         target::integer,</span>
<span class="s1">                         length::double precision as cost,</span>
<span class="s1">                         x1, y1, x2, y2,</span>
<span class="s1">                         rule, to_cost</span>
<span class="s1">                        FROM victoria&#39;</span><span class="p">,</span>
                <span class="mi">36339</span><span class="p">,</span> <span class="mi">22921</span><span class="p">,</span> <span class="k">false</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h3>Wrapper function with bounding box<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">gid</span><span class="p">,</span> <span class="n">AsText</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="k">AS</span> <span class="n">the_geom</span>
        <span class="k">FROM</span> <span class="n">shootingstar_sp</span><span class="p">(</span><span class="s1">&#39;victoria&#39;</span><span class="p">,</span> <span class="mi">36339</span><span class="p">,</span> <span class="mi">22921</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span>
                                 <span class="s1">&#39;length&#39;</span><span class="p">,</span><span class="k">true</span><span class="p">,</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../index.html">Home</a> &#187;</li>
        <li><a href="#">PostgreSQL / pgRouting</a></li>
      </ul>
    </div>

	<div class="footer">
      	&copy; Copyright, pgRouting Community<br/>
      	pgRouting website is hosted on <a href="https://github.com/pgRouting/website">Github</a> |
      	<script type="text/javascript">
      		document.write('<a href="mailto:' + new Array("project","pgrouting.org").join("@") + '">Contact administrators</a>');
      	</script>
    </div>

	<!-- Piwik -->
	<script type="text/javascript">
	var pkBaseURL = (("https:" == document.location.protocol) ? "https://stats.georepublic.net/" : "http://stats.georepublic.net/");
	document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
	</script><script type="text/javascript">
	try {
	var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 3);
	piwikTracker.trackPageView();
	piwikTracker.enableLinkTracking();
	} catch( err ) {}
	</script><noscript><p><img src="http://stats.georepublic.net/piwik.php?idsite=3" style="border:0" alt="" /></p></noscript>
	<!-- End Piwik Tag -->

  </body>
</html>